library(biomaRt)
mart <- useMart("ensembl", dataset = "ggallus_gene_ensembl")
mart <- useMart("ensembl", dataset = "ggallus_gene_ensembl")
gene_ids <- read.table("~/Desktop/bca/gene_isgs.csv", stringsAsFactors = FALSE)[,1]
gene_ids <- read.table("~/Desktop/bca/chicken_isgs.csv", stringsAsFactors = FALSE)[,1]
gene_ids
mapping <- getBM(attributes = c("external_gene_name", "ensembl_gene_id", "refseq_mrna"),
filters = "external_gene_name",
values = gene_ids, mart = mart)
head(mapping)
View(mapping)
write.table(mapping, file = "~/Desktop/bca/chicken_isgs_mapped.csv", sep = "\t",
quote = FALSE, row.names = FALSE, col.names = TRUE)
gene_ids <- read.table("~/Desktop/bca/chicken_isgs_mapped.csv", stringsAsFactors = FALSE)[,2]
gene_ids <- read.table("~/Desktop/bca/chicken_isgs_mapped.csv", stringsAsFactors = FALSE)[,1]
gene_ids <- read.table("~/Desktop/bca/chicken_isgs_mapped.csv", stringsAsFactors = FALSE)
gene_ids <- read.csv("~/Desktop/bca/chicken_isgs_mapped.csv", stringsAsFactors = FALSE)
View(gene_ids)
gene_ids <- read.csv("~/Desktop/bca/chicken_isgs_mapped.csv",
stringsAsFactors = FALSE,
sep = "\t")
View(gene_ids)
gene_ids
mapping <- getBM(attributes = c("ensembl_gene_id", "refseq_mrna"),
filters = "ensembl_gene_id",
values = gene_ids, mart = mart)
View(mapping)
gene_df <- read.csv("~/Desktop/bca/chicken_isgs_mapped.csv",
stringsAsFactors = FALSE,
sep = "\t")
gene_ids <- gene_df$ensembl_gene_id
mapping <- getBM(attributes = c("ensembl_gene_id", "refseq_mrna"),
filters = "ensembl_gene_id",
values = gene_ids, mart = mart)
View(mapping)
ensembl <- useMart("ensembl", dataset = "ggallus_gene_ensembl")
gene_df <- read.csv("~/Desktop/bca/chicken_isgs_mapped.csv",
stringsAsFactors = FALSE,
sep = "\t")
gene_ids <- gene_df$ensembl_gene_id
results <- getBM(attributes = c("chromosome_name", "start_position",
"end_position", "ensembl_gene_id"),
filters = "ensembl_gene_id",
values = gene_ids, mart = ensembl)
print(results)
bed <- data.frame("chr" = results$chromosome_name,
"start" = results$start_position,
"end" = results$end_position,
"name" = results$ensembl_gene_id,)
bed <- data.frame(chr = results$chromosome_name,
start = results$start_position - 1,
end = results$end_position,
name = results$ensembl_gene_id,)
bed <- data.frame(chr = results$chromosome_name,
start = results$start_position - 1,
end = results$end_position,
name = results$ensembl_gene_id)
write.table(bed, file = "~/Desktop/bca/chicken_isgs.bed", sep = "\t",
quote = FALSE, row.names = FALSE, col.names = FALSE)
